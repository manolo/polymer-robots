<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1" />
  <script src="bower_components/webcomponentsjs/webcomponents-lite.js"></script>
  <link rel="stylesheet" href="assets/robots-ui.css">
  <link rel="import" href="robots-ui.html">
  <link rel="import" href="bower_components/vaadin-pouchdb/vaadin-pouchdb.html">
</head>
<body unresolved />
  <vaadin-pouchdb dbname='chat' index="ts"></vaadin-pouchdb>
  <robots-ui></robots-ui>
  <script>
    HTMLImports.whenReady(function() {
      var ui = document.querySelector('robots-ui');
      var db = document.querySelector('vaadin-pouchdb');
      ui.robots = [
        'Sona', 'Boomer', 'Terra', 'Qwerty', 'Ayzoid', 'Ac', 'Scrappie', 'Skip', 'R2D2', 'Lego',
        'Plier', 'Grezzer', 'Ihuxroid', 'Akmoid', 'Talus', 'Cyb', 'Tera', 'Ratchet', 'Umap', 'Akbtron'
      ]
      ui.spin = true;
      db.query().then(function(rows) {
        ui.set('items', rows);
        ui.spin = false;
      });
      ui.addEventListener('new-msg', function(e) {
        db.post(e.detail);
      });
      ui._reload = function() {
        db.query().then(rows => {
          ui.set('items', rows);
        });
      }
      ui._reload();
    });
  </script>
</body>
</html>
